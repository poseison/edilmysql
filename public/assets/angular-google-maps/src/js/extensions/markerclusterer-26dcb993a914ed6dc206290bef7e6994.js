(function(){var t={}.hasOwnProperty,e=function(e,r){function s(){this.constructor=e}for(var i in r)t.call(r,i)&&(e[i]=r[i]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e};window.NgMapCluster=function(t){function r(t){r.__super__.constructor.call(this,t),this.markers_=new window.PropMap}return e(r,t),r.prototype.addMarker=function(t){var e,r;if(this.isMarkerAlreadyAdded_(t)){var s=this.markers_.get(t.key);if(s.getPosition().lat()==t.getPosition().lat()&&s.getPosition().lon()==t.getPosition().lon())return!1}if(this.center_){if(this.averageCenter_){var i=this.markers_.length+1,n=(this.center_.lat()*(i-1)+t.getPosition().lat())/i,o=(this.center_.lng()*(i-1)+t.getPosition().lng())/i;this.center_=new google.maps.LatLng(n,o),this.calculateBounds_()}}else this.center_=t.getPosition(),this.calculateBounds_();return t.isAdded=!0,this.markers_.push(t),e=this.markers_.length,r=this.markerClusterer_.getMaxZoom(),null!==r&&this.map_.getZoom()>r?t.getMap()!==this.map_&&t.setMap(this.map_):e<this.minClusterSize_?t.getMap()!==this.map_&&t.setMap(this.map_):e===this.minClusterSize_?this.markers_.values().forEach(function(t){t.setMap(null)}):t.setMap(null),!0},r.prototype.isMarkerAlreadyAdded_=function(t){return _.isNullOrUndefined(this.markers_.get(t.key))},r.prototype.getBounds=function(){var t,e=new google.maps.LatLngBounds(this.center_,this.center_),r=this.getMarkers().values();for(t=0;t<r.length;t++)e.extend(r[t].getPosition());return e},r.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=new PropMap,delete this.markers_},r}(Cluster),window.NgMapMarkerClusterer=function(t){function r(t,e,s){r.__super__.constructor.call(this,t,e,s),this.markers_=new window.PropMap}return e(r,t),r.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=new PropMap},r.prototype.removeMarker_=function(t){return this.markers_.get(t.key)?(t.setMap(null),this.markers_.remove(t.key),!0):!1},r.prototype.createClusters_=function(t){var e,r,s,i=this;if(this.ready_){0===t&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),s=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625));var n=this.getExtendedBounds(s),o=Math.min(t+this.batchSize_,this.markers_.length);for(e=t;o>e;e++)r=this.markers_.values()[e],!r.isAdded&&this.isMarkerInBounds_(r,n)&&(!this.ignoreHidden_||this.ignoreHidden_&&r.getVisible())&&this.addToClosestCluster_(r);if(o<this.markers_.length)this.timerRefStatic=setTimeout(function(){i.createClusters_(o)},0);else{for(e=0;e<this.clusters_.length;e++)this.clusters_[e].updateIcon_();delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this)}}},r.prototype.addToClosestCluster_=function(t){var e,r,s,i,n=4e4,o=null;for(e=0;e<this.clusters_.length;e++)s=this.clusters_[e],i=s.getCenter(),i&&(r=this.distanceBetweenPoints_(i,t.getPosition()),n>r&&(n=r,o=s));o&&o.isMarkerInClusterBounds(t)?o.addMarker(t):(s=new NgMapCluster(this),s.addMarker(t),this.clusters_.push(s))},r.prototype.redraw_=function(){this.createClusters_(0)},r.prototype.resetViewport_=function(t){var e;for(e=0;e<this.clusters_.length;e++)this.clusters_[e].remove();this.clusters_=[],this.markers_.values().forEach(function(e){e.isAdded=!1,t&&e.setMap(null)})},MarkerClusterer.prototype.extend=function(t,e){return function(t){var e;for(e in t.prototype)"constructor"!==e&&(this.prototype[e]=t.prototype[e]);return this}.apply(t,[e])},r}(MarkerClusterer)}).call(this);