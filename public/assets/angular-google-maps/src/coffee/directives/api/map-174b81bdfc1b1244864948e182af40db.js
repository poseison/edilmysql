(function(){var e=function(e,n){return function(){return e.apply(n,arguments)}},n={}.hasOwnProperty,t=function(e,t){function o(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e};angular.module("google-maps.directives.api").factory("Map",["$timeout","$q","Logger","GmapUtil","BaseObject","ExtendGWin","CtrlHandle","IsReady".ns(),"uuid".ns(),function(n,o,r,i,a,u,l,s,d){"use strict";var g,p,c;return g=r,p={mapTypeId:google.maps.MapTypeId.ROADMAP},c=function(n){function o(){this.link=e(this.link,this);var n,t;n=function(e){var n;return n=l.handle(e),e.ctrlType="Map",e.deferred.promise.then(function(){return u.init()}),_.extend(n,{getMap:function(){return e.map}})},this.controller=["$scope",n],t=this}return t(o,n),o.include(i),o.prototype.restrict="EMA",o.prototype.transclude=!0,o.prototype.replace=!1,o.prototype.template='<div class="angular-google-map"><div class="angular-google-map-container"></div><div ng-transclude style="display: none"></div></div>',o.prototype.scope={center:"=",zoom:"=",dragging:"=",control:"=",windows:"=",options:"=",events:"=",styles:"=",bounds:"="},o.prototype.link=function(e,n,t){var o,r,i,a,u,l,c,f,v,m,y;if(v=s.spawn(),c=function(){return function(){return v.deferred.resolve({instance:v.instance,map:y})}}(this),!this.validateCoords(e.center))return void g.error("angular-google-maps: could not find a valid center property");if(!angular.isDefined(e.zoom))return void g.error("angular-google-maps: map zoom property not set");if(r=angular.element(n),r.addClass("angular-google-map"),l={options:{}},t.options&&(l.options=e.options),t.styles&&(l.styles=e.styles),t.type&&(m=t.type.toUpperCase(),google.maps.MapTypeId.hasOwnProperty(m)?l.mapTypeId=google.maps.MapTypeId[t.type.toUpperCase()]:g.error('angular-google-maps: invalid map type "'+t.type+'"')),u=angular.extend({},p,l,{center:this.getCoords(e.center),draggable:this.isTrue(t.draggable),zoom:e.zoom,bounds:e.bounds}),y=new google.maps.Map(r.find("div")[1],u),y.nggmap_id=d.generate(),o=!1,y?(e.deferred.resolve(y),c()):google.maps.event.addListener(y,"tilesloaded ",function(n){return e.deferred.resolve(n),c()}),google.maps.event.addListener(y,"dragstart",function(){return o=!0,_.defer(function(){return e.$apply(function(e){return null!=e.dragging?e.dragging=o:void 0})})}),google.maps.event.addListener(y,"dragend",function(){return o=!1,_.defer(function(){return e.$apply(function(e){return null!=e.dragging?e.dragging=o:void 0})})}),google.maps.event.addListener(y,"drag",function(){var n;return n=y.center,_.defer(function(){return e.$apply(function(e){return angular.isDefined(e.center.type)?(e.center.coordinates[1]=n.lat(),e.center.coordinates[0]=n.lng()):(e.center.latitude=n.lat(),e.center.longitude=n.lng())})})}),google.maps.event.addListener(y,"zoom_changed",function(){return e.zoom!==y.zoom?_.defer(function(){return e.$apply(function(e){return e.zoom=y.zoom})}):void 0}),f=!1,google.maps.event.addListener(y,"center_changed",function(){var n;return n=y.center,f?void 0:_.defer(function(){return e.$apply(function(e){if(!y.dragging)if(angular.isDefined(e.center.type)){if(e.center.coordinates[1]!==n.lat()&&(e.center.coordinates[1]=n.lat()),e.center.coordinates[0]!==n.lng())return e.center.coordinates[0]=n.lng()}else if(e.center.latitude!==n.lat()&&(e.center.latitude=n.lat()),e.center.longitude!==n.lng())return e.center.longitude=n.lng()})})}),google.maps.event.addListener(y,"idle",function(){var n,t,o;return n=y.getBounds(),t=n.getNorthEast(),o=n.getSouthWest(),_.defer(function(){return e.$apply(function(e){return null!==e.bounds&&void 0!==e.bounds&&void 0!==e.bounds?(e.bounds.northeast={latitude:t.lat(),longitude:t.lng()},e.bounds.southwest={latitude:o.lat(),longitude:o.lng()}):void 0})})}),angular.isDefined(e.events)&&null!==e.events&&angular.isObject(e.events)){a=function(n){return function(){return e.events[n].apply(e,[y,n,arguments])}};for(i in e.events)e.events.hasOwnProperty(i)&&angular.isFunction(e.events[i])&&google.maps.event.addListener(y,i,a(i))}return y.getOptions=function(){return u},e.map=y,null!=t.control&&null!=e.control&&(e.control.refresh=function(e){return function(n){var o;if(null!=y)return google.maps.event.trigger(y,"resize"),null!=(null!=n?n.latitude:void 0)&&null!=(null!=n?n.latitude:void 0)?(o=e.getCoords(n),e.isTrue(t.pan)?y.panTo(o):y.setCenter(o)):void 0}}(this),e.control.getGMap=function(){return function(){return y}}(this),e.control.getMapOptions=function(){return u}),e.$watch("center",function(n){return function(r){var i;return i=n.getCoords(r),i.lat()!==y.center.lat()||i.lng()!==y.center.lng()?(f=!0,o||(n.validateCoords(r)||g.error("Invalid center for newValue: "+JSON.stringify(r)),n.isTrue(t.pan)&&e.zoom===y.zoom?y.panTo(i):y.setCenter(i)),f=!1):void 0}}(this),!0),e.$watch("zoom",function(e){return e!==y.zoom?_.defer(function(){return y.setZoom(e)}):void 0}),e.$watch("bounds",function(e,n){var t,o,r;if(e!==n)return null==e.northeast.latitude||null==e.northeast.longitude||null==e.southwest.latitude||null==e.southwest.longitude?void g.error("Invalid map bounds for new value: "+JSON.stringify(e)):(o=new google.maps.LatLng(e.northeast.latitude,e.northeast.longitude),r=new google.maps.LatLng(e.southwest.latitude,e.southwest.longitude),t=new google.maps.LatLngBounds(r,o),y.fitBounds(t))}),e.$watch("options",function(){return function(e,n){return _.isEqual(e,n)||(l.options=e,null==y)?void 0:y.setOptions(l)}}(this),!0),e.$watch("styles",function(){return function(e,n){return _.isEqual(e,n)||(l.styles=e,null==y)?void 0:y.setOptions(l)}}(this),!0)},o}(a)}])}).call(this);