(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function o(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return o.prototype=i.prototype,t.prototype=new o,t.__super__=i.prototype,t};angular.module("google-maps.directives.api.models.parent").factory("PolylinesParentModel",["$timeout","Logger","ModelKey","ModelsWatcher","PropMap","PolylineChildModel",function(e,o,s,r,n,l){var h;return h=function(e){function s(e,i,r,l,h){var c;this.scope=e,this.element=i,this.attrs=r,this.gMap=l,this.defaults=h,this.modelKeyComparison=t(this.modelKeyComparison,this),this.setChildScope=t(this.setChildScope,this),this.createChild=t(this.createChild,this),this.pieceMeal=t(this.pieceMeal,this),this.createAllNew=t(this.createAllNew,this),this.watchIdKey=t(this.watchIdKey,this),this.createChildScopes=t(this.createChildScopes,this),this.watchOurScope=t(this.watchOurScope,this),this.watchDestroy=t(this.watchDestroy,this),this.rebuildAll=t(this.rebuildAll,this),this.doINeedToWipe=t(this.doINeedToWipe,this),this.watchModels=t(this.watchModels,this),this.watch=t(this.watch,this),s.__super__.constructor.call(this,e),c=this,this.$log=o,this.plurals=new n,this.scopePropNames=["path","stroke","clickable","draggable","editable","geodesic","icons","visible"],_.each(this.scopePropNames,function(t){return function(e){return t[e+"Key"]=void 0}}(this)),this.models=void 0,this.firstTime=!0,this.$log.info(this),this.watchOurScope(e),this.createChildScopes()}return i(s,e),s.include(r),s.prototype.watch=function(t,e,i){return t.$watch(e,function(t){return function(o,s){return o!==s?(t[i]="function"==typeof o?o():o,_async.each(_.values(t.plurals),function(o){return o.scope[e]="self"===t[i]?o:o[t[i]]},function(){})):void 0}}(this))},s.prototype.watchModels=function(t){return t.$watch("models",function(e){return function(i,o){return _.isEqual(i,o)?void 0:e.doINeedToWipe(i)?e.rebuildAll(t,!0,!0):e.createChildScopes(!1)}}(this),!0)},s.prototype.doINeedToWipe=function(t){var e;return e=null!=t?0===t.length:!0,this.plurals.length>0&&e},s.prototype.rebuildAll=function(t,e,i){return _async.each(this.plurals.values(),function(){return function(t){return t.destroy()}}(this),function(t){return function(){return i&&delete t.plurals,t.plurals=new n,e?t.createChildScopes():void 0}}(this))},s.prototype.watchDestroy=function(t){return t.$on("$destroy",function(e){return function(){return e.rebuildAll(t,!1,!0)}}(this))},s.prototype.watchOurScope=function(t){return _.each(this.scopePropNames,function(e){return function(i){var o;return o=i+"Key",e[o]="function"==typeof t[i]?t[i]():t[i],e.watch(t,i,o)}}(this))},s.prototype.createChildScopes=function(t){return null==t&&(t=!0),angular.isUndefined(this.scope.models)?void this.$log.error("No models to create polylines from! I Need direct models!"):null!=this.gMap&&null!=this.scope.models?(this.watchIdKey(this.scope),t?this.createAllNew(this.scope,!1):this.pieceMeal(this.scope,!1)):void 0},s.prototype.watchIdKey=function(t){return this.setIdKey(t),t.$watch("idKey",function(e){return function(i,o){return i!==o&&null==i?(e.idKey=i,e.rebuildAll(t,!0,!0)):void 0}}(this))},s.prototype.createAllNew=function(t,e){return null==e&&(e=!1),this.models=t.models,this.firstTime&&(this.watchModels(t),this.watchDestroy(t)),_async.each(t.models,function(t){return function(e){return t.createChild(e,t.gMap)}}(this),function(t){return function(){return t.firstTime=!1}}(this))},s.prototype.pieceMeal=function(t,e){return null==e&&(e=!0),this.models=t.models,null!=t&&null!=t.models&&t.models.length>0&&this.plurals.length>0?this.figureOutState(this.idKey,t,this.plurals,this.modelKeyComparison,function(t){return function(e){var i;return i=e,_async.each(i.removals,function(e){var i;return i=t.plurals[e],null!=i?(i.destroy(),t.plurals.remove(e)):void 0},function(){return _async.each(i.adds,function(e){return t.createChild(e,t.gMap)},function(){})})}}(this)):this.rebuildAll(this.scope,!0,!0)},s.prototype.createChild=function(t,e){var i,o;return o=this.scope.$new(!1),this.setChildScope(o,t),o.$watch("model",function(t){return function(e,i){return e!==i?t.setChildScope(o,e):void 0}}(this),!0),o["static"]=this.scope["static"],i=new l(o,this.attrs,e,this.defaults,t),null==t[this.idKey]?void this.$log.error("Polyline model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):(this.plurals.put(t[this.idKey],i),i)},s.prototype.setChildScope=function(t,e){return _.each(this.scopePropNames,function(i){return function(o){var s,r;return s=o+"Key",r="self"===i[s]?e:e[i[s]],r!==t[o]?t[o]=r:void 0}}(this)),t.model=e},s.prototype.modelKeyComparison=function(t,e){return _.isEqual(this.evalModelHandle(t,this.scope.path),this.evalModelHandle(e,this.scope.path))},s}(s)}])}).call(this);