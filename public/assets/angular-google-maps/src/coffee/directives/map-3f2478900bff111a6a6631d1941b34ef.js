(function(){angular.module("google-maps").directive("googleMap",["$log","$timeout",function(e){"use strict";var n,t,o;return o=function(e){return angular.isDefined(e)&&null!==e&&e===!0||"1"===e||"y"===e||"true"===e},directives.api.utils.Logger.logger=e,n={mapTypeId:google.maps.MapTypeId.ROADMAP},t=function(e){return new google.maps.LatLng(e.latitude,e.longitude)},{self:this,restrict:"ECMA",transclude:!0,replace:!1,template:'<div class="angular-google-map"><div class="angular-google-map-container"></div><div ng-transclude style="display: none"></div></div>',scope:{center:"=center",zoom:"=zoom",dragging:"=dragging",control:"=",windows:"=windows",options:"=options",events:"=events",styles:"=styles",bounds:"=bounds"},controller:["$scope",function(e){return{getMap:function(){return e.map}}}],link:function(r,a,u){var l,i,s,g,d,p,c,f;if(!angular.isDefined(r.center)||!angular.isDefined(r.center.latitude)||!angular.isDefined(r.center.longitude))return void e.error("angular-google-maps: could not find a valid center property");if(!angular.isDefined(r.zoom))return void e.error("angular-google-maps: map zoom property not set");if(i=angular.element(a),i.addClass("angular-google-map"),d={options:{}},u.options&&(d.options=r.options),u.styles&&(d.styles=r.styles),u.type&&(c=u.type.toUpperCase(),google.maps.MapTypeId.hasOwnProperty(c)?d.mapTypeId=google.maps.MapTypeId[u.type.toUpperCase()]:e.error('angular-google-maps: invalid map type "'+u.type+'"')),f=new google.maps.Map(i.find("div")[1],angular.extend({},n,d,{center:new google.maps.LatLng(r.center.latitude,r.center.longitude),draggable:o(u.draggable),zoom:r.zoom,bounds:r.bounds})),l=!1,google.maps.event.addListener(f,"dragstart",function(){return l=!0,_.defer(function(){return r.$apply(function(e){return null!=e.dragging?e.dragging=l:void 0})})}),google.maps.event.addListener(f,"dragend",function(){return l=!1,_.defer(function(){return r.$apply(function(e){return null!=e.dragging?e.dragging=l:void 0})})}),google.maps.event.addListener(f,"drag",function(){var e;return e=f.center,_.defer(function(){return r.$apply(function(n){return n.center.latitude=e.lat(),n.center.longitude=e.lng()})})}),google.maps.event.addListener(f,"zoom_changed",function(){return r.zoom!==f.zoom?_.defer(function(){return r.$apply(function(e){return e.zoom=f.zoom})}):void 0}),p=!1,google.maps.event.addListener(f,"center_changed",function(){var e;return e=f.center,p?void 0:_.defer(function(){return r.$apply(function(n){return f.dragging||(n.center.latitude!==e.lat()&&(n.center.latitude=e.lat()),n.center.longitude===e.lng())?void 0:n.center.longitude=e.lng()})})}),google.maps.event.addListener(f,"idle",function(){var e,n,t;return e=f.getBounds(),n=e.getNorthEast(),t=e.getSouthWest(),_.defer(function(){return r.$apply(function(e){return null!==e.bounds&&void 0!==e.bounds&&void 0!==e.bounds?(e.bounds.northeast={latitude:n.lat(),longitude:n.lng()},e.bounds.southwest={latitude:t.lat(),longitude:t.lng()}):void 0})})}),angular.isDefined(r.events)&&null!==r.events&&angular.isObject(r.events)){g=function(e){return function(){return r.events[e].apply(r,[f,e,arguments])}};for(s in r.events)r.events.hasOwnProperty(s)&&angular.isFunction(r.events[s])&&google.maps.event.addListener(f,s,g(s))}return r.map=f,null!=u.control&&null!=r.control&&(r.control.refresh=function(){return function(e){var n;if(null!=f)return google.maps.event.trigger(f,"resize"),null!=(null!=e?e.latitude:void 0)&&null!=(null!=e?e.latitude:void 0)?(n=t(e),o(u.pan)?f.panTo(n):f.setCenter(n)):void 0}}(this),r.control.getGMap=function(){return function(){return f}}(this)),r.$watch("center",function(n,a){var i;return i=t(n),n===a||i.lat()===f.center.lat()&&i.lng()===f.center.lng()?void 0:(p=!0,l||((null==n.latitude||null==n.longitude)&&e.error("Invalid center for newValue: "+JSON.stringify(n)),o(u.pan)&&r.zoom===f.zoom?f.panTo(i):f.setCenter(i)),p=!1)},!0),r.$watch("zoom",function(e,n){return e!==n&&e!==f.zoom?_.defer(function(){return f.setZoom(e)}):void 0}),r.$watch("bounds",function(n,t){var o,r,a;if(n!==t)return null==n.northeast.latitude||null==n.northeast.longitude||null==n.southwest.latitude||null==n.southwest.longitude?void e.error("Invalid map bounds for new value: "+JSON.stringify(n)):(r=new google.maps.LatLng(n.northeast.latitude,n.northeast.longitude),a=new google.maps.LatLng(n.southwest.latitude,n.southwest.longitude),o=new google.maps.LatLngBounds(a,r),f.fitBounds(o))}),r.$watch("options",function(){return function(e,n){return _.isEqual(e,n)||(d.options=e,null==f)?void 0:f.setOptions(d)}}(this),!0),r.$watch("styles",function(){return function(e,n){return _.isEqual(e,n)||(d.styles=e,null==f)?void 0:f.setOptions(d)}}(this),!0)}}}])}).call(this);