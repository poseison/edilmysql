(function(){angular.module("google-maps").directive("rectangle",["$log","$timeout",function(n){var e,t,o,i,u;return u=function(n){return angular.isUndefined(n.sw.latitude)||angular.isUndefined(n.sw.longitude)||angular.isUndefined(n.ne.latitude)||angular.isUndefined(n.ne.longitude)?!1:!0},t=function(n){var e;return e=new google.maps.LatLngBounds(new google.maps.LatLng(n.sw.latitude,n.sw.longitude),new google.maps.LatLng(n.ne.latitude,n.ne.longitude))},o=function(n,e){return n.fitBounds(e)},i=function(n){return angular.isDefined(n)&&null!==n&&n===!0||"1"===n||"y"===n||"true"===n},e={},{restrict:"ECA",require:"^googleMap",replace:!0,scope:{bounds:"=",stroke:"=",clickable:"=",draggable:"=",editable:"=",fill:"=",visible:"="},link:function(l,r,a,s){return angular.isUndefined(l.bounds)||null===l.bounds||angular.isUndefined(l.bounds.sw)||null===l.bounds.sw||angular.isUndefined(l.bounds.ne)||null===l.bounds.ne||!u(l.bounds)?void n.error("rectangle: no valid bound attribute found"):s.getScope().deferred.promise.then(function(){return function(u){var r,s,d,g;return r=function(n){var t;return t=angular.extend({},e,{map:u,bounds:n,strokeColor:l.stroke&&l.stroke.color,strokeOpacity:l.stroke&&l.stroke.opacity,strokeWeight:l.stroke&&l.stroke.weight,fillColor:l.fill&&l.fill.color,fillOpacity:l.fill&&l.fill.opacity}),angular.forEach({clickable:!0,draggable:!1,editable:!1,visible:!0},function(n,e){return t[e]=angular.isUndefined(l[e])||null===l[e]?n:l[e]}),t},d=new google.maps.Rectangle(r(t(l.bounds))),i(a.fit)&&o(u,bounds),s=!1,google.maps.event.addListener(d,"mousedown",function(){google.maps.event.addListener(d,"mousemove",function(){return s=!0,_.defer(function(){return l.$apply(function(n){return null!=n.dragging?n.dragging=s:void 0})})}),google.maps.event.addListener(d,"mouseup",function(){return google.maps.event.clearListeners(d,"mousemove"),google.maps.event.clearListeners(d,"mouseup"),s=!1,_.defer(function(){return l.$apply(function(n){return null!=n.dragging?n.dragging=s:void 0})})})}),g=!1,google.maps.event.addListener(d,"bounds_changed",function(){var n,e,t;return n=d.getBounds(),e=n.getNorthEast(),t=n.getSouthWest(),g?void 0:_.defer(function(){return l.$apply(function(n){d.dragging||null!==n.bounds&&void 0!==n.bounds&&void 0!==n.bounds&&(n.bounds.ne={latitude:e.lat(),longitude:e.lng()},n.bounds.sw={latitude:t.lat(),longitude:t.lng()})})})}),l.$watch("bounds",function(e,t){var o;if(!_.isEqual(e,t))return g=!0,s||((null==e.sw.latitude||null==e.sw.longitude||null==e.ne.latitude||null==e.ne.longitude)&&n.error("Invalid bounds for newValue: "+JSON.stringify(e)),o=new google.maps.LatLngBounds(new google.maps.LatLng(e.sw.latitude,e.sw.longitude),new google.maps.LatLng(e.ne.latitude,e.ne.longitude)),d.setBounds(o)),g=!1},!0),angular.isDefined(l.editable)&&l.$watch("editable",function(n){return d.setEditable(n)}),angular.isDefined(l.draggable)&&l.$watch("draggable",function(n){return d.setDraggable(n)}),angular.isDefined(l.visible)&&l.$watch("visible",function(n){return d.setVisible(n)}),angular.isDefined(l.stroke)&&(angular.isDefined(l.stroke.color)&&l.$watch("stroke.color",function(){return d.setOptions(r(d.getBounds()))}),angular.isDefined(l.stroke.weight)&&l.$watch("stroke.weight",function(){return d.setOptions(r(d.getBounds()))}),angular.isDefined(l.stroke.opacity)&&l.$watch("stroke.opacity",function(){return d.setOptions(r(d.getBounds()))})),angular.isDefined(l.fill)&&(angular.isDefined(l.fill.color)&&l.$watch("fill.color",function(){return d.setOptions(r(d.getBounds()))}),angular.isDefined(l.fill.opacity)&&l.$watch("fill.opacity",function(){return d.setOptions(r(d.getBounds()))})),l.$on("$destroy",function(){return d.setMap(null)})}}(this))}}}])}).call(this);