"use strict";describe("ngCsv directive",function(){var t,e;beforeEach(module("ngCsv.directives")),beforeEach(inject(function(c,a){t=c,e=a,e.test=[[1,2,3],[4,5,6]],e.testObj=[{a:1,b:2,c:3},{a:4,b:5,c:6}]})),it("Replaces the element with the appropriate content",function(){var c=t("<div ng-csv='test'></div>")(e);e.$digest(),expect(c.html()).toMatch(/<div class="element"/),expect(c.html()).toMatch(/a class="hidden.*" ng-hide="true"/gi)}),it("Sets default filename",function(){var c=t("<div ng-csv='test'></div>")(e);e.$digest(),expect(c.html()).toContain('download="download.csv"')}),it("Accepts ng-click attribute ",function(){e.clicked=!1,e.clickTest=function(){e.clicked=!0},expect(e.clicked).toBeFalsy();var c=t("<div ng-csv='test' ng-click='clickTest()'></div>")(e);c.triggerHandler("click"),e.$digest(),expect(c.html()).toContain('download="download.csv"'),expect(e.clicked).toBeTruthy()}),it("Sets the provided filename",function(){var c=t("<div ng-csv='test' filename='custom.csv'></div>")(e);e.$digest(),expect(c.html()).toContain('download="custom.csv"')}),it("Builds the csv format correctly",function(){var c=t("<div ng-csv='test' filename='custom.csv'></div>")(e);e.$digest();var a=c.isolateScope();expect(a.$eval(a.data)).toBe(e.test),expect(a.csv).toBe("data:text/csv;charset=utf-8,1,2,3%0D%0A4,5,6%0D%0A")}),it("Accepts $scope expressions as ng-csv",function(){e.getTest=function(){return[[1,2,3],[4,5,6]]};var c=t("<div ng-csv='getTest()' filename='custom.csv'></div>")(e);e.$digest();var a=c.isolateScope();expect(a.$eval(a.data)).toEqual(e.getTest()),expect(a.csv).toBe("data:text/csv;charset=utf-8,1,2,3%0D%0A4,5,6%0D%0A")}),it("Creates a header row if provided",function(){var c=t("<div ng-csv=\"test\" csv-header=\"['A','B','C']\" filename=\"custom.csv\"></div>")(e);e.$digest();var a=c.isolateScope();expect(a.$eval(a.data)).toEqual(e.test),expect(a.$eval(a.header)).toEqual(["A","B","C"]),expect(a.csv).toBe("data:text/csv;charset=utf-8,A,B,C%0D%0A1,2,3%0D%0A4,5,6%0D%0A")}),it("Accepts optional text-delimiter attribute (input array)",function(){e.testDelim=[[1,"a",2],["b","c",3]];var c=t('<div ng-csv="testDelim" text-delimiter=\'"\' filename="custom.csv"></div>')(e);e.$digest();var a=c.isolateScope();expect(a.$eval(a.data)).toEqual(e.testDelim),expect(a.csv).toBe("data:text/csv;charset=utf-8,1,%22a%22,2%0D%0A%22b%22,%22c%22,3%0D%0A")}),it("Accepts optional text-delimiter attribute (input object)",function(){e.testDelim=[{a:1,b:"a",c:2},{a:"b",b:"c",c:3}];var c=t('<div ng-csv="testDelim" text-delimiter=\'"\' filename="custom.csv"></div>')(e);e.$digest();var a=c.isolateScope();expect(a.$eval(a.data)).toEqual(e.testDelim),expect(a.csv).toBe("data:text/csv;charset=utf-8,1,%22a%22,2%0D%0A%22b%22,%22c%22,3%0D%0A")}),it("Accepts optional field-separator attribute (input array)",function(){var c=t('<div ng-csv="test" field-separator=\';\' filename="custom.csv"></div>')(e);e.$digest();var a=c.isolateScope();expect(a.$eval(a.data)).toEqual(e.test),expect(a.csv).toBe("data:text/csv;charset=utf-8,1;2;3%0D%0A4;5;6%0D%0A")}),it("Accepts optional field-separator attribute (input object)",function(){var c=t('<div ng-csv="testObj" field-separator=\';\' filename="custom.csv"></div>')(e);e.$digest();var a=c.isolateScope();expect(a.$eval(a.data)).toEqual(e.testObj),expect(a.csv).toBe("data:text/csv;charset=utf-8,1;2;3%0D%0A4;5;6%0D%0A")}),it("Accepts dynamic field-separator attribute (input object)",function(){e.sep="	";var c=t('<div ng-csv="testObj" field-separator="{{sep}}" filename="custom.csv"></div>')(e);e.$digest(),e.sep=";",e.$digest();var a=c.isolateScope();expect(a.fieldSep).toBe(e.sep),expect(a.$eval(a.data)).toEqual(e.testObj),expect(a.csv).toBe("data:text/csv;charset=utf-8,1;2;3%0D%0A4;5;6%0D%0A")})});