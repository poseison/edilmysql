!function(){angular.module("ngCsv.config",[]).value("ngCsv.config",{debug:!0}).config(["$compileProvider",function(e){angular.isDefined(e.urlSanitizationWhitelist)?e.urlSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/):e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),angular.module("ngCsv.directives",[]),angular.module("ngCsv",["ngCsv.config","ngCsv.directives","ngSanitize"]),angular.module("ngCsv.directives",[]).directive("ngCsv",["$parse","$q",function(e,n){return{restrict:"AC",replace:!0,transclude:!0,scope:{data:"&ngCsv",filename:"@filename",header:"&csvHeader",txtDelim:"@textDelimiter",fieldSep:"@fieldSeparator",lazyLoad:"@lazyLoad",ngClick:"&"},controller:["$scope","$element","$attrs","$transclude",function(e,a,i){var t=function(n){return"string"==typeof n?(n=n.replace(/"/g,'""'),e.txtDelim&&(n=e.txtDelim+n+e.txtDelim),n):"boolean"==typeof n?n?"TRUE":"FALSE":n};e.csv="",angular.isDefined(e.lazyLoad)&&"true"==e.lazyLoad||angular.isArray(e.data)&&e.$watch("data",function(){e.buildCsv(e.data(),function(){})},!0),e.buildCsv=function(a,l){var r="data:text/csv;charset=utf-8,";n.when(a).then(function(n){if(angular.isDefined(i.csvHeader)){var a,l,c=e.$eval(e.header);angular.isArray(c)?a=c:(a=[],angular.forEach(c,function(e){this.push(t(e))},a)),l=a.join(e.fieldSep?e.fieldSep:","),r+=l+"\n"}var d;d=angular.isArray(n)?n:n(),angular.forEach(d,function(n,a){var i,l;angular.isArray(n)?l=n:(l=[],angular.forEach(n,function(e){this.push(t(e))},l)),i=l.join(e.fieldSep?e.fieldSep:","),r+=a<d.length?i+"\n":i}),e.csv=encodeURI(r)}).then(function(){l()})},e.getFilename=function(){return e.filename||"download.csv"}}],template:'<div class="csv-wrap"><div class="element" ng-transclude></div><a class="hidden-link" ng-hide="true" ng-href="{{ csv }}" download="{{ getFilename() }}"></a></div>',link:function(e,n){function a(){t[0].href="",t[0].click(),t[0].href=e.csv,t[0].click()}var i=angular.element(n.children()[0]),t=angular.element(n.children()[1]);i.bind("click",function(){e.buildCsv(e.data(),function(){a()}),e.ngClick&&e.ngClick()})}}}])}(window,document);