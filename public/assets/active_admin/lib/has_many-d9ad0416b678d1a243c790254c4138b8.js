(function(){var e,t;$(function(){return $(document).on("click","a.button.has_many_remove",function(e){var n,a;return e.preventDefault(),n=$(this).closest(".has_many_container"),a=$(this).closest("fieldset"),t(n),n.trigger("has_many_remove:before",[a]),a.remove()}),$(document).on("click","a.button.has_many_add",function(e){var n,a,r,i,s,o;return e.preventDefault(),s=$(this).closest(".has_many_container"),s.trigger(n=$.Event("has_many_add:before")),n.isDefaultPrevented()?void 0:(i=s.data("has_many_index")||s.children("fieldset").length-1,s.data({has_many_index:++i}),o=new RegExp($(this).data("placeholder"),"g"),r=$(this).data("html").replace(o,i),a=$(r).insertBefore(this),t(s),s.trigger("has_many_add:after",[a]))}),$(document).on("change",'.has_many_container[data-sortable] :input[name$="[_destroy]"]',function(){return t($(this).closest(".has_many"))}),e(),$(document).on("has_many_add:after",".has_many_container",e)}),e=function(){var e;return e=$(".has_many_container[data-sortable]:not(.ui-sortable)"),e.sortable({items:"> fieldset",handle:"> ol > .handle",stop:t}),e.each(t)},t=function(e){var t,n;return e=e instanceof jQuery?e:$(this),t=e.data("sortable"),n=0,e.children("fieldset").each(function(){var e,a;return e=$(this).find("> ol > .input > :input[name$='[_destroy]']"),a=$(this).find("> ol > .input > :input[name$='["+t+"]']"),a.length?a.val(e.is(":checked")?"":n++):void 0})}}).call(this);